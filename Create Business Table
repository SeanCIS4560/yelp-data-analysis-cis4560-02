--What this code does is define the schema to read the raw JSON data.
USE sdewert;

-- Drop table if exists (for clean start)
DROP TABLE IF EXISTS business;

-- Create business table
CREATE EXTERNAL TABLE IF NOT EXISTS business (
    business_id STRING,
    name STRING,
    address STRING,
    city STRING,
    state STRING,
    postal_code STRING,
    latitude DOUBLE,
    longitude DOUBLE,
    stars DOUBLE,
    review_count INT,
    is_open INT,
    attributes STRING,
    categories STRING,
    hours STRING
)
ROW FORMAT SERDE 'org.apache.hive.hcatalog.data.JsonSerDe'
STORED AS TEXTFILE
LOCATION '/user/sdewert/yelp_project/business/';

-- Verify data loaded
SELECT COUNT(*) as total_businesses FROM business;
